Failure # 1 (occurred at 2020-08-12_14-39-49)
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TypeError): [36mray::PPO.train()[39m (pid=82923, ip=192.168.1.65)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 211, in make_shape
    shape = tensor_shape.as_shape(v)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1218, in as_shape
    return TensorShape(shape)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 771, in __init__
    self._dims = [as_dimension(d) for d in dims_iter]
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 771, in <listcomp>
    self._dims = [as_dimension(d) for d in dims_iter]
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 716, in as_dimension
    return Dimension(value)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 200, in __init__
    None)
  File "<string>", line 3, in raise_from
TypeError: Dimension value must be integer or None or have an __index__ method, got 1.0

During handling of the above exception, another exception occurred:

[36mray::PPO.train()[39m (pid=82923, ip=192.168.1.65)
  File "python/ray/_raylet.pyx", line 407, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 90, in __init__
    Trainer.__init__(self, config, env, logger_creator)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 450, in __init__
    super().__init__(config, logger_creator)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/tune/trainable.py", line 175, in __init__
    self._setup(copy.deepcopy(self.config))
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 623, in _setup
    self._init(self.config, self.env_creator)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 115, in _init
    self.config["num_workers"])
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 696, in _make_workers
    logdir=self.logdir)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/evaluation/worker_set.py", line 59, in __init__
    RolloutWorker, env_creator, policy, 0, self._local_config)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/evaluation/worker_set.py", line 282, in _make_worker
    extra_python_environs=extra_python_environs)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 379, in __init__
    self._build_policy_map(policy_dict, policy_config)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 937, in _build_policy_map
    policy_map[name] = cls(obs_space, act_space, merged_conf)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/policy/tf_policy_template.py", line 143, in __init__
    obs_include_prev_action_reward=obs_include_prev_action_reward)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/policy/dynamic_tf_policy.py", line 164, in __init__
    **self.config["model"].get("custom_model_config", {}))
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/models/catalog.py", line 396, in get_model_v2
    name, **model_kwargs)
  File "/opt/anaconda3/lib/python3.7/site-packages/ray/rllib/models/tf/fcnet.py", line 36, in __init__
    shape=(np.product(obs_space.shape), ), name="observations")
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_layer.py", line 295, in Input
    input_layer = InputLayer(**input_layer_config)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_layer.py", line 154, in __init__
    ragged=ragged)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/keras/backend.py", line 1087, in placeholder
    x = array_ops.placeholder(dtype, shape=shape, name=name)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/array_ops.py", line 3026, in placeholder
    return gen_array_ops.placeholder(dtype=dtype, shape=shape, name=name)
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6674, in placeholder
    shape = _execute.make_shape(shape, "shape")
  File "/opt/anaconda3/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 213, in make_shape
    raise TypeError("Error converting %s to a TensorShape: %s." % (arg_name, e))
TypeError: Error converting shape to a TensorShape: Dimension value must be integer or None or have an __index__ method, got 1.0.

